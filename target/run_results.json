{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-04-26T02:03:13.917144Z", "invocation_id": "1e6872fc-cd8a-4471-8343-78eb99984c47", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T02:03:00.539132Z", "completed_at": "2025-04-26T02:03:00.552650Z"}, {"name": "execute", "started_at": "2025-04-26T02:03:00.553606Z", "completed_at": "2025-04-26T02:03:02.151850Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.614168643951416, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "intrepid-craft-450709-f9", "job_id": "a6d18e28-b0bf-41d6-a0de-ba2e0619fe7a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.key_academy.base_ga4_events", "compiled": true, "compiled_code": "\n\nSELECT\n  -- Event metadata\n  TIMESTAMP_MICROS(event_timestamp) AS event_timestamp,\n  TIMESTAMP_MICROS(event_previous_timestamp) AS event_previous_timestamp,\n  TIMESTAMP_MICROS(user_first_touch_timestamp) AS user_first_touch_timestamp,\n  PARSE_DATE('%Y%m%d', event_date) AS event_date,\n  \n  event_value_in_usd,\n  event_bundle_sequence_id,\n  event_server_timestamp_offset,\n\n  -- Privacy info\n  privacy_info.analytics_storage,\n  privacy_info.ads_storage,\n  privacy_info.uses_transient_token,\n\n  -- User properties\n  up.key AS user_properties_key,\n  up.value.string_value AS user_properties_string_value,\n  up.value.int_value AS user_properties_int_value,\n  up.value.float_value AS user_properties_float_value,\n  up.value.double_value AS user_properties_double_value,\n\n  -- User LTV\n  user_ltv.revenue,\n  user_ltv.currency,\n  \n  -- User info\n  event_name,\n  user_id,\n  user_pseudo_id,\n  is_active_user,\n\n  -- Device info\n  device.category AS device_category,\n  device.mobile_brand_name AS device_mobile_brand_name,\n  device.mobile_model_name AS device_mobile_model_name,\n  device.mobile_marketing_name AS device_mobile_marketing_name,\n  device.mobile_os_hardware_model AS device_mobile_os_hardware_model,\n  device.operating_system AS device_operating_system,\n  device.operating_system_version AS device_operating_system_version,\n  device.vendor_id AS device_vendor_id,\n  device.advertising_id AS device_advertising_id,\n  device.language AS device_language,\n  device.is_limited_ad_tracking AS device_is_limited_ad_tracking,\n  device.time_zone_offset_seconds AS device_time_zone_offset_seconds,\n  device.browser AS device_browser,\n  device.browser_version AS device_browser_version,\n  device.web_info.browser AS device_web_info_browser,\n  device.web_info.browser_version AS device_web_info_browser_version,\n  device.web_info.hostname AS device_web_info_hostname,\n\n  -- Location info\n  geo.country AS country,\n  geo.region AS region,\n  geo.city AS city,\n  geo.continent AS continent,\n  geo.sub_continent AS sub_continent,\n  geo.metro AS metro,\n  \n  -- app info metadata\n  app_info.id AS app_info_id,\n  app_info.version AS app_info_version,\n  app_info.install_source AS app_install_source,\n  app_info.firebase_app_id AS app_firebase_app_id,\n  app_info.install_store AS app_install_store,\n\n  -- traffic source metadata\n  traffic_source.name AS traffic_source_name,\n  traffic_source.medium AS traffic_source_medium,\n  traffic_source.source AS traffic_source_source,\n\n  -- collected traffic source metadata\n  collected_traffic_source.manual_campaign_id AS collected_traffic_source_manual_campaign_id,\n  collected_traffic_source.manual_campaign_name AS collected_traffic_source_manual_campaign_name,\n  collected_traffic_source.manual_source AS collected_traffic_source_manual_source,\n  collected_traffic_source.manual_medium AS collected_traffic_source_manual_medium,\n  collected_traffic_source.manual_term AS collected_traffic_source_manual_term,\n  collected_traffic_source.manual_content AS collected_traffic_source_manual_content,\n  collected_traffic_source.manual_source_platform AS collected_traffic_source_manual_source_platform,\n  collected_traffic_source.manual_creative_format AS collected_traffic_source_manual_creative_format,\n  collected_traffic_source.manual_marketing_tactic AS collected_traffic_source_manual_marketing_tactic,\n  collected_traffic_source.gclid AS collected_traffic_source_gclid,\n  collected_traffic_source.dclid AS collected_traffic_source_dclid,\n  collected_traffic_source.srsltid AS collected_traffic_source_srsltid, \n\n  stream_id,\n  platform,\n  batch_event_index,\n  batch_page_id,\n  batch_ordering_id,\n\n  event_dimensions.hostname AS event_dimensions_hostname,\n\n  -- ecommerce metadata\n  ecommerce.total_item_quantity,\n  ecommerce.purchase_revenue_in_usd,\n  ecommerce.purchase_revenue,\n  ecommerce.refund_value_in_usd,\n  ecommerce.refund_value,\n  ecommerce.shipping_value_in_usd,\n  ecommerce.shipping_value,\n  ecommerce.tax_value_in_usd,\n  ecommerce.tax_value,\n  ecommerce.unique_items,\n  ecommerce.transaction_id,\n\n  -- Event parameters\n  ep.key AS event_param_key,\n  ep.value.string_value AS event_param_string_value,\n  ep.value.int_value AS event_param_int_value,\n  ep.value.float_value AS event_param_float_value,\n  ep.value.double_value AS event_param_double_value,\n\n  -- item metadata\n  i.item_id,\n  i.item_name,\n  i.item_brand,\n  i.item_variant,\n  i.item_category,\n  i.item_category2,\n  i.item_category3,\n  i.item_category4,\n  i.item_category5,\n  i.price_in_usd,\n  i.price,\n  i.quantity,\n  i.item_revenue_in_usd,\n  i.item_revenue,\n  i.item_refund_in_usd,\n  i.item_refund,\n  i.coupon,\n  i.affiliation,\n  i.location_id,\n  i.item_list_id,\n  i.item_list_name,\n  i.item_list_index,\n  i.promotion_id,\n  i.promotion_name,\n  i.creative_name,\n  i.creative_slot,\n  \n  -- Item parameters\n  ip.key AS item_param_key,\n  ip.value.string_value AS item_param_string_value,\n  ip.value.int_value AS item_param_int_value,\n  ip.value.float_value AS item_param_float_value,\n  ip.value.double_value AS item_param_double_value,\n\n  -- publisher\n  publisher.ad_revenue_in_usd,\n  publisher.ad_format,\n  publisher.ad_source_name,\n  publisher.ad_unit_id,\n\n  -- Manual Campaign Fields\n  session_traffic_source_last_click.manual_campaign.campaign_id AS manual_campaign_id,\n  session_traffic_source_last_click.manual_campaign.campaign_name AS manual_campaign_name,\n  session_traffic_source_last_click.manual_campaign.source AS manual_source,\n  session_traffic_source_last_click.manual_campaign.medium AS manual_medium,\n  session_traffic_source_last_click.manual_campaign.term AS manual_term,\n  session_traffic_source_last_click.manual_campaign.content AS manual_content,\n  session_traffic_source_last_click.manual_campaign.source_platform AS manual_source_platform,\n  session_traffic_source_last_click.manual_campaign.creative_format AS manual_creative_format,\n  session_traffic_source_last_click.manual_campaign.marketing_tactic AS manual_marketing_tactic,\n\n  -- Google Ads Campaign Fields\n  session_traffic_source_last_click.google_ads_campaign.customer_id AS google_ads_customer_id,\n  session_traffic_source_last_click.google_ads_campaign.account_name AS google_ads_account_name,\n  session_traffic_source_last_click.google_ads_campaign.campaign_id AS google_ads_campaign_id,\n  session_traffic_source_last_click.google_ads_campaign.campaign_name AS google_ads_campaign_name,\n  session_traffic_source_last_click.google_ads_campaign.ad_group_id AS google_ads_ad_group_id,\n  session_traffic_source_last_click.google_ads_campaign.ad_group_name AS google_ads_ad_group_name,\n\n  -- Cross Channel Campaign Fields\n  session_traffic_source_last_click.cross_channel_campaign.campaign_id AS cross_channel_campaign_id,\n  session_traffic_source_last_click.cross_channel_campaign.campaign_name AS cross_channel_campaign_name,\n  session_traffic_source_last_click.cross_channel_campaign.source AS cross_channel_source,\n  session_traffic_source_last_click.cross_channel_campaign.medium AS cross_channel_medium,\n  session_traffic_source_last_click.cross_channel_campaign.source_platform AS cross_channel_source_platform,\n  session_traffic_source_last_click.cross_channel_campaign.default_channel_group AS cross_channel_default_group,\n  session_traffic_source_last_click.cross_channel_campaign.primary_channel_group AS cross_channel_primary_group,\n\n  -- SA360 Campaign Fields\n  session_traffic_source_last_click.sa360_campaign.campaign_id AS sa360_campaign_id,\n  session_traffic_source_last_click.sa360_campaign.campaign_name AS sa360_campaign_name,\n  session_traffic_source_last_click.sa360_campaign.source AS sa360_source,\n  session_traffic_source_last_click.sa360_campaign.medium AS sa360_medium,\n  session_traffic_source_last_click.sa360_campaign.ad_group_id AS sa360_ad_group_id,\n  session_traffic_source_last_click.sa360_campaign.ad_group_name AS sa360_ad_group_name,\n  session_traffic_source_last_click.sa360_campaign.creative_format AS sa360_creative_format,\n  session_traffic_source_last_click.sa360_campaign.engine_account_name AS sa360_engine_account_name,\n  session_traffic_source_last_click.sa360_campaign.engine_account_type AS sa360_engine_account_type,\n  session_traffic_source_last_click.sa360_campaign.manager_account_name AS sa360_manager_account_name,\n\n   -- CM360 (Campaign Manager 360) Campaign Fields\n  session_traffic_source_last_click.cm360_campaign.campaign_id AS cm360_campaign_id,\n  session_traffic_source_last_click.cm360_campaign.campaign_name AS cm360_campaign_name,\n  session_traffic_source_last_click.cm360_campaign.source AS cm360_source,\n  session_traffic_source_last_click.cm360_campaign.medium AS cm360_medium,\n  session_traffic_source_last_click.cm360_campaign.account_id AS cm360_account_id,\n  session_traffic_source_last_click.cm360_campaign.account_name AS cm360_account_name,\n  session_traffic_source_last_click.cm360_campaign.advertiser_id AS cm360_advertiser_id,\n  session_traffic_source_last_click.cm360_campaign.advertiser_name AS cm360_advertiser_name,\n  session_traffic_source_last_click.cm360_campaign.creative_id AS cm360_creative_id,\n  session_traffic_source_last_click.cm360_campaign.creative_format AS cm360_creative_format,\n  session_traffic_source_last_click.cm360_campaign.creative_name AS cm360_creative_name,\n  session_traffic_source_last_click.cm360_campaign.creative_type AS cm360_creative_type,\n  session_traffic_source_last_click.cm360_campaign.creative_type_id AS cm360_creative_type_id,\n  session_traffic_source_last_click.cm360_campaign.creative_version AS cm360_creative_version,\n  session_traffic_source_last_click.cm360_campaign.placement_id AS cm360_placement_id,\n  session_traffic_source_last_click.cm360_campaign.placement_cost_structure AS cm360_placement_cost_structure,\n  session_traffic_source_last_click.cm360_campaign.placement_name AS cm360_placement_name,\n  session_traffic_source_last_click.cm360_campaign.rendering_id AS cm360_rendering_id,\n  session_traffic_source_last_click.cm360_campaign.site_id AS cm360_site_id,\n  session_traffic_source_last_click.cm360_campaign.site_name AS cm360_site_name,\n\n  -- DV360 (Display & Video 360) Campaign Fields\n  session_traffic_source_last_click.dv360_campaign.campaign_id AS dv360_campaign_id,\n  session_traffic_source_last_click.dv360_campaign.campaign_name AS dv360_campaign_name,\n  session_traffic_source_last_click.dv360_campaign.source AS dv360_source,\n  session_traffic_source_last_click.dv360_campaign.medium AS dv360_medium,\n  session_traffic_source_last_click.dv360_campaign.advertiser_id AS dv360_advertiser_id,\n  session_traffic_source_last_click.dv360_campaign.advertiser_name AS dv360_advertiser_name,\n  session_traffic_source_last_click.dv360_campaign.creative_id AS dv360_creative_id,\n  session_traffic_source_last_click.dv360_campaign.creative_format AS dv360_creative_format,\n  session_traffic_source_last_click.dv360_campaign.creative_name AS dv360_creative_name,\n  session_traffic_source_last_click.dv360_campaign.exchange_id AS dv360_exchange_id,\n  session_traffic_source_last_click.dv360_campaign.exchange_name AS dv360_exchange_name,\n  session_traffic_source_last_click.dv360_campaign.insertion_order_id AS dv360_insertion_order_id,\n  session_traffic_source_last_click.dv360_campaign.insertion_order_name AS dv360_insertion_order_name,\n  session_traffic_source_last_click.dv360_campaign.line_item_id AS dv360_line_item_id,\n  session_traffic_source_last_click.dv360_campaign.line_item_name AS dv360_line_item_name,\n  session_traffic_source_last_click.dv360_campaign.partner_id AS dv360_partner_id,\n  session_traffic_source_last_click.dv360_campaign.partner_name AS dv360_partner_name,\n\n\nFROM `intrepid-craft-450709-f9`.`ga4_copy`.`events_*`\nLEFT JOIN UNNEST(event_params) AS ep\nLEFT JOIN UNNEST(user_properties) AS up\nLEFT JOIN UNNEST(items) AS i  \nLEFT JOIN UNNEST(i.item_params) AS ip", "relation_name": "`intrepid-craft-450709-f9`.`key_academy`.`base_ga4_events`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T02:03:02.159725Z", "completed_at": "2025-04-26T02:03:02.164878Z"}, {"name": "execute", "started_at": "2025-04-26T02:03:02.165939Z", "completed_at": "2025-04-26T02:03:09.861274Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.702940225601196, "adapter_response": {"_message": "CREATE TABLE (19.0 rows, 75.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 19, "bytes_processed": 79243824, "bytes_billed": 79691776, "location": "US", "project_id": "intrepid-craft-450709-f9", "job_id": "0028d072-f943-4f18-8c19-e40262978bca", "slot_ms": 25810}, "message": "CREATE TABLE (19.0 rows, 75.6 MiB processed)", "failures": null, "unique_id": "model.key_academy.stg_agg_registration_funnel_summary", "compiled": true, "compiled_code": "\n\nWITH registration_events AS (\n  SELECT\n    user_pseudo_id,\n    event_date,\n    platform,\n    event_name,\n    event_timestamp,\n    -- Create a unique session identifier\n    CASE WHEN event_name = 'session_start' \n         THEN CONCAT(user_pseudo_id, CAST(event_timestamp AS STRING)) \n         ELSE NULL END AS session_id\n  FROM `intrepid-craft-450709-f9`.`key_academy`.`base_ga4_events`\n  WHERE event_name IN ('session_start', 'sign_up', 'sign_up_request', 'login')\n),\n\nuser_journeys AS (\n  SELECT\n    user_pseudo_id,\n    event_date,\n    platform,\n    -- Get the first timestamp for each event type per user per day\n    MAX(CASE WHEN event_name = 'session_start' THEN event_timestamp END) AS session_start_time,\n    MAX(CASE WHEN event_name = 'sign_up' THEN event_timestamp END) AS sign_up_time,\n    MAX(CASE WHEN event_name = 'sign_up_request' THEN event_timestamp END) AS sign_up_request_time,\n    MAX(CASE WHEN event_name = 'login' THEN event_timestamp END) AS login_time,\n    -- Get any session ID (we'll use this for counting)\n    MAX(session_id) AS session_id\n  FROM registration_events\n  GROUP BY ALL\n),\n\nfunnel_metrics AS (\n  SELECT\n    event_date,\n    platform,\n    -- Count sessions using SUM CASE WHEN\n    SUM(CASE WHEN session_start_time IS NOT NULL THEN 1 ELSE 0 END) AS sessions,\n    -- Sign up must happen after session start\n    SUM(CASE \n          WHEN sign_up_time IS NOT NULL AND \n               (session_start_time IS NULL OR sign_up_time >= session_start_time)\n          THEN 1 ELSE 0 \n        END) AS create_account,\n    -- Sign up request must happen after sign up\n    SUM(CASE \n          WHEN sign_up_request_time IS NOT NULL AND \n               (sign_up_time IS NULL OR sign_up_request_time >= sign_up_time)\n          THEN 1 ELSE 0 \n        END) AS create_password,\n    -- Login must happen after sign up request\n    SUM(CASE \n          WHEN login_time IS NOT NULL AND \n               (sign_up_request_time IS NULL OR login_time >= sign_up_request_time)\n          THEN 1 ELSE 0 \n        END) AS confirm_email,\n  FROM user_journeys\n  GROUP BY ALL\n)\n\nSELECT \n  event_date,\n  platform,\n  sessions,\n  create_account,\n  create_password,\n  confirm_email\nFROM funnel_metrics", "relation_name": "`intrepid-craft-450709-f9`.`key_academy`.`stg_agg_registration_funnel_summary`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T02:03:09.866576Z", "completed_at": "2025-04-26T02:03:09.869888Z"}, {"name": "execute", "started_at": "2025-04-26T02:03:09.870288Z", "completed_at": "2025-04-26T02:03:13.910058Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.044890880584717, "adapter_response": {"_message": "CREATE TABLE (19.0 rows, 883.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 19, "bytes_processed": 883, "bytes_billed": 10485760, "location": "US", "project_id": "intrepid-craft-450709-f9", "job_id": "0ff8d57b-7e41-4f8a-811c-a18c174a1195", "slot_ms": 26729}, "message": "CREATE TABLE (19.0 rows, 883.0 Bytes processed)", "failures": null, "unique_id": "model.key_academy.mart_agg_registration_funnel_summary", "compiled": true, "compiled_code": "\n\nSELECT * \nFROM `intrepid-craft-450709-f9`.`key_academy`.`stg_agg_registration_funnel_summary`", "relation_name": "`intrepid-craft-450709-f9`.`key_academy`.`mart_agg_registration_funnel_summary`", "batch_results": null}], "elapsed_time": 14.991116046905518, "args": {"warn_error_options": {"include": [], "exclude": []}, "defer": false, "log_format": "default", "partial_parse_file_diff": true, "partial_parse": true, "indirect_selection": "eager", "full_refresh": true, "exclude": [], "use_colors": true, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors_file": true, "state_modified_compare_more_unrendered_values": false, "static_parser": true, "printer_width": 80, "project_dir": "/home/jddeguia/key-academy/key_academy", "macro_debugging": false, "version_check": true, "invocation_command": "dbt run -s +mart_agg_registration_funnel_summary --full-refresh", "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_vars": false, "log_format_file": "debug", "require_resource_names_without_spaces": false, "log_path": "/home/jddeguia/key-academy/key_academy/logs", "cache_selected_only": false, "require_batched_execution_for_custom_microbatch_strategy": false, "profiles_dir": "/home/jddeguia/.dbt", "require_nested_cumulative_type_params": false, "introspect": true, "log_file_max_bytes": 10485760, "print": true, "empty": false, "quiet": false, "strict_mode": false, "which": "run", "source_freshness_run_project_hooks": false, "write_json": true, "populate_cache": true, "log_level": "info", "skip_nodes_if_on_run_start_fails": false, "show_resource_report": false, "log_level_file": "debug", "send_anonymous_usage_stats": true, "select": ["+mart_agg_registration_funnel_summary"], "favor_state": false, "vars": {}}}