{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-04-27T07:44:04.504906Z", "invocation_id": "5f742e90-0b9a-4936-9dd3-7ed7232fc4e2", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-27T07:44:03.005773Z", "completed_at": "2025-04-27T07:44:03.014120Z"}, {"name": "execute", "started_at": "2025-04-27T07:44:03.014650Z", "completed_at": "2025-04-27T07:44:04.497503Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4928631782531738, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "intrepid-craft-450709-f9", "job_id": "28ac2096-e14d-4d33-9634-82b4942a0d8a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.key_academy.mart_agg_platform_summary", "compiled": true, "compiled_code": "WITH revenue AS (\n    SELECT\n        DATE(created_at) AS date,\n        ROUND(SUM(\n        CASE\n            WHEN selected_payment_kind = 'OneTime' THEN SAFE_CAST(cart_including_all_discounts_gross_price AS FLOAT64)\n            WHEN selected_payment_kind = 'Monthly' THEN SAFE_CAST(total_amount_gross AS FLOAT64)\n            ELSE 0\n        END\n    ), 2) AS revenue\n  FROM `intrepid-craft-450709-f9`.`key_academy`.`base_billing_orders`\n  GROUP BY ALL\n),\n\ncourses_progress AS (\n    SELECT\n        module_started_date AS date,\n        SUM(trials) AS trials,\n        SUM(lessons_completed) AS lessons_completed,\n        SUM(certificates) AS certificates\n    FROM `intrepid-craft-450709-f9`.`key_academy`.`mart_agg_course_progress`\n    GROUP BY ALL\n),\n\nlicenses_sold AS (\n    SELECT\n        DATE(module_started_at) AS date,\n        SUM(CASE WHEN license_id IS NOT NULL THEN 1 ELSE 0 END) AS licenses_sold\n    FROM `intrepid-craft-450709-f9`.`key_academy`.`mart_user_module_progress`\n    GROUP BY ALL\n),\n\nregistrations AS (\n    SELECT\n        DATE(registered_at) AS date,\n        COUNT(*) AS registrations\n    FROM `intrepid-craft-450709-f9`.`key_academy`.`base_auth_users`    \n    GROUP BY ALL\n),\n\nlogins AS (\n    SELECT\n        event_date AS date,\n        SUM(CASE WHEN event_name = 'login' THEN 1 ELSE 0 END) AS logins,\n        SUM(CASE WHEN is_active_user IS TRUE THEN 1 ELSE 0 END) AS active_users,    \n    FROM `intrepid-craft-450709-f9`.`key_academy`.`stg_ga4_account_events`\n    GROUP BY ALL\n),\n\nsummary AS (\n    SELECT \n        date,\n        reg.registrations,\n        c.trials,\n        l.licenses_sold,\n        r.revenue,\n        log.logins,\n        log.active_users,\n        c.lessons_completed,\n        c.certificates      \n    FROM logins log\n    FULL JOIN courses_progress c USING (date)\n    FULL JOIN licenses_sold l USING (date)\n    FULL JOIN registrations reg USING (date)\n    FULL JOIN revenue r USING (date)\n)\n\nSELECT * \nFROM summary\nORDER BY date DESC", "relation_name": "`intrepid-craft-450709-f9`.`key_academy`.`mart_agg_platform_summary`", "batch_results": null}], "elapsed_time": 4.727630138397217, "args": {"write_json": true, "introspect": true, "log_level_file": "debug", "state_modified_compare_vars": false, "defer": false, "macro_debugging": false, "favor_state": false, "state_modified_compare_more_unrendered_values": false, "cache_selected_only": false, "require_yaml_configuration_for_mf_time_spines": false, "select": ["mart_agg_platform_summary"], "profiles_dir": "/home/jddeguia/.dbt", "log_path": "/home/jddeguia/key-academy/key_academy/logs", "require_resource_names_without_spaces": false, "populate_cache": true, "skip_nodes_if_on_run_start_fails": false, "version_check": true, "log_level": "info", "exclude": [], "project_dir": "/home/jddeguia/key-academy/key_academy", "print": true, "source_freshness_run_project_hooks": false, "partial_parse": true, "log_file_max_bytes": 10485760, "which": "run", "warn_error_options": {"include": [], "exclude": []}, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "vars": {}, "static_parser": true, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse_file_diff": true, "use_colors": true, "show_resource_report": false, "empty": false, "invocation_command": "dbt run -s mart_agg_platform_summary", "require_nested_cumulative_type_params": false, "printer_width": 80, "quiet": false, "use_colors_file": true, "log_format_file": "debug", "require_batched_execution_for_custom_microbatch_strategy": false, "strict_mode": false}}